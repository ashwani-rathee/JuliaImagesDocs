<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/'</script><script charset="utf-8" src="../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>ORB · ImageFeatures</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="..\..\..\filter/">ImageFiltering</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Packages</button><div class="nav-dropdown-container nav-mega-dropdown-container"><div class="nav-mega-column"><div class="column-header">High-Level Packages</div><ul class="column-content"><a class="nav-link nav-item" href="..\..\..\filter/">ImageFiltering</a><a class="nav-link nav-item" href="..\..\..\dither/">DitherPunk</a><a class="nav-link nav-item" href="..\..\..\binarize/">ImageBinarization</a><a class="nav-link nav-item" href="..\..\..\contrast\dev/">ImageContrastAdjustment</a><a class="nav-link nav-item" href="..\..\..\morphology/">ImageMorphology</a><a class="nav-link active nav-item" href="..\..\dev/">ImageFeatures</a></ul></div></div></div><div class="search nav-item"><input id="search-input" placeholder="Search..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><nav class="toc"><h1>ImageFeatures</h1><select id="version-selector" onchange="window.location.href=this.value" style="visibility: hidden"></select><form action="../search.html" class="search" id="search-form"><input id="search-query" name="q" placeholder="Search docs" type="text"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="brief.html">BRIEF</a></li><li class="current"><a class="toctext" href="orb.html">ORB</a><ul class="internal"><li><a class="toctext" href="#Example-1">Example</a></li></ul></li><li><a class="toctext" href="brisk.html">BRISK</a></li><li><a class="toctext" href="freak.html">FREAK</a></li><li><a class="toctext" href="glcm.html">Gray level co-occurence matrix</a></li><li><a class="toctext" href="lbp.html">Local binary patterns</a></li><li><a class="toctext" href="object_detection.html">Object Detection using HOG</a></li></ul></li><li><a class="toctext" href="../function_reference.html">Function reference</a></li></ul></nav><article id="docs"><header><nav><ul><li>Tutorials</li><li><a href="orb.html">ORB</a></li></ul><a class="edit-page" href="https://github.com/JuliaImages/ImageFeatures.jl/blob/master/docs/src/tutorials/orb.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>ORB</span><a class="fa fa-bars" href="#"></a></div></header><p>The <em>ORB</em> descriptor is a somewhat similar to <a href="brief.html">BRIEF</a>. It doesn’t have an elaborate sampling pattern as <a href="brisk.html">BRISK</a> or <a href="freak.html">FREAK</a>.</p><p>However, there are two main differences between ORB and BRIEF:</p><ul><li><p>ORB uses an orientation compensation mechanism, making it rotation invariant.</p></li><li><p>ORB learns the optimal sampling pairs, whereas BRIEF uses randomly chosen sampling pairs.</p></li></ul><p>The ORB descriptor uses the intensity centroid as a measure of orientation. To calculate the centroid, we first need to find the moment of a patch, which is given by <code>Mpq = x,yxpyqI(x,y)</code>. The centroid, or ‘centre of mass' is then given by <code>C=(M10M00, M01M00)</code>.</p><p>The vector from the corner’s center to the centroid gives the orientation of the patch. Now, the patch can be rotated to some predefined canonical orientation before calculating the descriptor, thus achieving rotation invariance.</p><p>ORB tries to take sampling pairs which are uncorrelated so that each new pair will bring new information to the descriptor, thus maximizing the amount of information the descriptor carries. We also want high variance among the pairs making a feature more discriminative, since it responds differently to inputs. To do this, we consider the sampling pairs over keypoints in standard datasets and then do a greedy evaluation of all the pairs in order of distance from mean till the number of desired pairs are obtained i.e. the size of the descriptor.</p><p>The descriptor is built using intensity comparisons of the pairs. For each pair if the first point has greater intensity than the second, then 1 is written else 0 is written to the corresponding bit of the descriptor.</p><h2><a class="nav-anchor" href="#Example-1" id="Example-1">Example</a></h2><p>Let us take a look at a simple example where the ORB descriptor is used to match two images where one has been translated by <code>(50, 40)</code> pixels and then rotated by an angle of 75 degrees. We will use the <code>lighthouse</code> image from the <a href="https://github.com/JuliaImages/TestImages.jl">TestImages</a> package for this example.</p><p>First, let us create the two images we will match using ORB.</p><div><pre><code class="language-julia">using ImageFeatures, TestImages, Images, ImageDraw, CoordinateTransformations

img = testimage("lighthouse")
img1 = Gray.(img)
rot = recenter(RotMatrix(5pi/6), [size(img1)...] .÷ 2)  # a rotation around the center
tform = rot ∘ Translation(-50, -40)
img2 = warp(img1, tform, indices(img1))</code></pre></div><p>The ORB descriptor calculates the keypoints as well as the descriptor, unlike <a href="brief.html">BRIEF</a>. To create the ORB descriptor, we first need to define the parameters by calling the <a href="../function_reference.html#ImageFeatures.ORB"><code>ORB</code></a> constructor.</p><div><pre><code class="language-julia">orb_params = ORB(num_keypoints = 1000)</code></pre></div><p>Now pass the image with the parameters to the <a href="../function_reference.html#ImageFeatures.create_descriptor"><code>create_descriptor</code></a> function.</p><div><pre><code class="language-julia">desc_1, ret_keypoints_1 = create_descriptor(img1, orb_params)
desc_2, ret_keypoints_2 = create_descriptor(img2, orb_params)</code></pre></div><p>The obtained descriptors can be used to find the matches between the two images using the <a href="../function_reference.html#ImageFeatures.match_keypoints"><code>match_keypoints</code></a> function.</p><div><pre><code class="language-julia">matches = match_keypoints(ret_keypoints_1, ret_keypoints_2, desc_1, desc_2, 0.2)</code></pre></div><p>We can use the <a href="https://github.com/JuliaImages/ImageDraw.jl">ImageDraw.jl</a> package to view the results.</p><div><pre><code class="language-julia">grid = hcat(img1, img2)
offset = CartesianIndex(0, size(img1, 2))
map(m -&gt; draw!(grid, LineSegment(m[1], m[2] + offset)), matches)</code></pre><pre><code class="language-none">WARNING: one(ColorTypes.Gray{FixedPointNumbers.Normed{UInt8,8}}) will soon switch to returning 1; you might need to switch to `oneunit`
Stacktrace:
 [1] depwarn(::String, ::Symbol) at ./deprecated.jl:70
 [2] one(::Type{ColorTypes.Gray{FixedPointNumbers.Normed{UInt8,8}}}) at /home/travis/.julia/v0.6/ColorTypes/src/traits.jl:341
 [3] draw! at /home/travis/.julia/v0.6/ImageDraw/src/line2d.jl:64 [inlined] (repeats 2 times)
 [4] _collect(::Array{Array{CartesianIndex{2},1},1}, ::Base.Generator{Array{Array{CartesianIndex{2},1},1},ex-2.##3#4}, ::Base.EltypeUnknown, ::Base.HasShape) at ./array.jl:483
 [5] map(::Function, ::Array{Array{CartesianIndex{2},1},1}) at ./abstractarray.jl:1868
 [6] cd(::Documenter.Expanders.##8#10{Module}, ::String) at ./file.jl:70
 [7] (::Documenter.Utilities.##19#20{Documenter.Expanders.##7#9{Documenter.Documents.Page,Module},Base.PipeEndpoint,Base.PipeEndpoint,Pipe,Array{UInt8,1}})() at /home/travis/.julia/v0.6/Documenter/src/Utilities/Utilities.jl:591
 [8] withoutput(::Documenter.Expanders.##7#9{Documenter.Documents.Page,Module}) at /home/travis/.julia/v0.6/Documenter/src/Utilities/Utilities.jl:589
 [9] runner(::Type{Documenter.Expanders.ExampleBlocks}, ::Base.Markdown.Code, ::Documenter.Documents.Page, ::Documenter.Documents.Document) at /home/travis/.julia/v0.6/Documenter/src/Expanders.jl:478
 [10] dispatch(::Type{Documenter.Expanders.ExpanderPipeline}, ::Base.Markdown.Code, ::Vararg{Any,N} where N) at /home/travis/.julia/v0.6/Documenter/src/Selectors.jl:168
 [11] expand(::Documenter.Documents.Document) at /home/travis/.julia/v0.6/Documenter/src/Expanders.jl:31
 [12] runner(::Type{Documenter.Builder.ExpandTemplates}, ::Documenter.Documents.Document) at /home/travis/.julia/v0.6/Documenter/src/Builder.jl:178
 [13] dispatch(::Type{Documenter.Builder.DocumentPipeline}, ::Documenter.Documents.Document, ::Vararg{Documenter.Documents.Document,N} where N) at /home/travis/.julia/v0.6/Documenter/src/Selectors.jl:168
 [14] cd(::Documenter.##2#3{Documenter.Documents.Document}, ::String) at ./file.jl:70
 [15] #makedocs#1(::Bool, ::Array{Any,1}, ::Function) at /home/travis/.julia/v0.6/Documenter/src/Documenter.jl:203
 [16] (::Documenter.#kw##makedocs)(::Array{Any,1}, ::Documenter.#makedocs) at ./&lt;missing&gt;:0
 [17] include_from_node1(::String) at ./loading.jl:576
 [18] include(::String) at ./sysimg.jl:14
 [19] eval(::Module, ::Any) at ./boot.jl:235
 [20] process_options(::Base.JLOptions) at ./client.jl:286
 [21] _start() at ./client.jl:371
while loading /home/travis/.julia/v0.6/ImageFeatures/docs/make.jl, in expression starting on line 3</code></pre></div><p><img alt="" src="orb_example.jpg"/></p><footer><hr/><a class="previous" href="brief.html"><span class="direction">Previous</span><span class="title">BRIEF</span></a><a class="next" href="brisk.html"><span class="direction">Next</span><span class="title">BRISK</span></a></footer></article></body></HTML>